sap.ui.define(["aow/artifact/controller/MainView.controller","aow/artifact/model/formatter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/Fragment","sap/ui/model/Sorter"],function(e,t,r,i,s,o){"use strict";return e.extend("aow.artifact.controller.AllPage",{formatter:t,onInit:function(){this.oRouter=this.getRouter();this._oRouterArgs=null;this.oRouter.getRoute("all").attachMatched(this._onRouteMatched,this)},_onRouteMatched:function(e){this._oRouterArgs=e.getParameter("arguments");this._oRouterArgs["?query"]=this._oRouterArgs["?query"]||{};if(this._oRouterArgs["?query"].search||this._oRouterArgs["?query"].filterType){this._applySearchFilter(this._oRouterArgs["?query"].search,this._oRouterArgs["?query"].filterType)}if(this._validateSortingParameter(this._oRouterArgs["?query"].sortKey,this._oRouterArgs["?query"].descending)){this._applySorting(this._oRouterArgs["?query"].sortKey,this._oRouterArgs["?query"].descending)}},liveSearch:function(e){const t=this.getView().getModel("settings");let r=t.getProperty("/search");let i=t.getProperty("/filterSearch");this._applySearchFilter(r,i);this._oRouterArgs["?query"].search=r;this._oRouterArgs["?query"].filterType=i;this._setQueryHash()},openSettingsDialog:function(){var e=this.getView();if(!this._settingsDialog){this._settingsDialog=s.load({id:e.getId(),name:"aow.artifact.fragment.Dialog",controller:this}).then(function(t){e.addDependent(t);return t})}this._settingsDialog.then(function(e){e.open()})},handleConfirm:function(e){var t=e.getParameter("sortItem").getKey();var r=e.getParameter("sortDescending");this._applySorting(t,r);this._oRouterArgs["?query"].sortKey=t;this._oRouterArgs["?query"].descending=r;this._setQueryHash()},_applySearchFilter:function(e,t){if(!e){e=""}if(!this._validateFilterType(t)){t=""}this.getView().getModel("settings").setProperty("/search",e);this.getView().getModel("settings").setProperty("/filterSearch",t);const s=this.getView().byId("all-list");const o=s.getBinding("items");const a=new r({path:"name",operator:i.Contains,value1:e});const n=new r({path:"description",operator:i.Contains,value1:e});const l=new r({path:"type",operator:i.Contains,value1:t});const u=new r({filters:[a,n],and:false});o.filter(new r({filters:[u,l],and:true}))},_applySorting:function(e,t){const r=this.getView().byId("all-list").getBinding("items");const i=new o({path:e,descending:t});r.sort(i)},_setQueryHash:function(){const e=Object.keys(this._oRouterArgs["?query"]).sort().reduce((e,t)=>{e[t]=this._oRouterArgs["?query"][t];return e},{});var t="all?";for(var r in e){if(e[r]!==undefined&&e[r]!==null&&e[r]!==""){if(r===Object.keys(e)[0]){t+=r+"="+e[r]}else{t+="&"+r+"="+e[r]}}}this.oRouter.getHashChanger().setHash(t)},_validateFilterType(e){var t=this.byId("trend-list-bar-segmented").getItems();var r=false;for(var i=0;i<t.length;i++){if(t[i].getKey()===e){r=true}}if(e&&e!==""&&e!=="all"&&r){return true}else{return false}},_validateSortingParameter(e,t){if(!e&&e===""&&e===null&&t===undefined&&t===null){return false}var r=false;if(e==="name"||e==="updatedAt"||e==="createdAt"){r=true}var i=false;if(t==="true"||t==="false"){i=true}if(r&&i){return true}else{return false}}})});